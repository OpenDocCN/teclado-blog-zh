<html>
<head>
<title>Day 28 Project: Web Scraping | Teclado</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>第28天项目:网络搜集| Teclado</h1>
<blockquote>原文：<a href="https://blog.teclado.com/python-30-day-28-project-web-scraping/">https://blog.teclado.com/python-30-day-28-project-web-scraping/</a></blockquote><div><article class="pb-12 prose prose-p:font-copy col-start-2 dark:prose-invert">
                    
                    <p>欢迎来到Python 系列<a href="https://blog.teclado.com/30-days-of-python/"> 30天</a><a href="/30-days-of-python/python-30-day-28-type-hinting">第28 </a>天项目！今天，我们将继续探索第三方模块，编写一个程序来自动为我们从网页中抓取内容！</p>
<p>为了做到这一点，我们将使用一个名为<code>BeautifulSoup</code>的库，用于解析和搜索HTML文档。HTML是一种标记语言，用于为网页内容提供结构和意义。</p>
<p>在我们更详细地查看<code>BeautifulSoup</code>之前，我们需要了解一下网页是如何构造的，以及我们如何通过编程来导航它们。</p>
<p>记住，如果你喜欢这种媒体，我们已经为这篇博文准备了一个<a href="https://youtu.be/lZwMZOv-7KA">视频演示</a>！</p>
<h2>HTML快速入门</h2>
<p>正如我在介绍中提到的，HTML是一种标记语言，用于为网页内容提供结构和意义。</p>
<p>标记语言是一种以计算机可以理解的方式注释文本的语言。标记语言的另一个例子是<a href="https://www.markdownguide.org/basic-syntax/"> Markdown </a>，它被用在各种论坛、博客和聊天应用程序上，以指示文本应该如何被格式化。</p>
<p>下面是一些描述一个简单网页的HTML。</p>
<div class="codehilite"><pre><span/><code><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">"en"</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"description"</span> <span class="na">content</span><span class="o">=</span><span class="s">"A simple page that greets the world with enthusiasm."</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Hello World!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<p>第一行包含<code>&lt;!DOCTYPE html&gt;</code>，它实际上只是一个标签，让计算机知道接下来的内容应该是什么格式。这对浏览器来说很重要，因为虽然HTML5现在是标准，但一些网站使用其他更老的格式和不同的语法。</p>
<p>一个HTML文档的主要内容是由标签组成的，所以让我们来谈谈这些标签是如何工作的。</p>
<h3>HTML标签</h3>
<p>标签由几个组件组成，HTML中有许多不同类型的元素，我们可以为它们创建标签，每种元素都有自己的名称和特殊含义。我们没有时间在这里讨论所有的元素，我们也不需要这样做，因为当<em>构建</em>网站时，知道使用哪个元素确实是一个需要考虑的问题。</p>
<p>当我们想要创建一个HTML元素时，这个元素的名字被放在尖括号中，就像这样:<code>&lt;html&gt;</code>。这种结构被称为标签。</p>
<p>通常标签有一个伴随的结束标签，在元素名称前有一个<code>/</code>。我们可以在上面的文档中看到一个关于<code>html</code>、<code>head</code>、<code>body</code>、<code>title</code>和<code>h1</code>元素的例子。</p>
<p>当一个HTML元素有一个开始和结束标记时，放置在这些标记之间的任何内容都被认为是在该元素内部。通过嵌套元素，我们可以给出一个页面结构。</p>
<p>例如，让我们看看下面这段HTML代码:</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
        Spicy jalapeno bacon ipsum dolor amet id tongue pork belly andouille.
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>这里我们有一些<a href="https://baconipsum.com/">辣培根ipsum </a>文本位于一组<code>&lt;p&gt;</code>标签中，这些标签用于表示一段文本。这些<code>&lt;p&gt;</code>标签是一组<code>&lt;div&gt;</code>标签中的<em>，用于定义一些通用的内容组。</em></p>
<p>理解HTML的层次本质非常重要，因为它将允许我们稍后轻松地遍历文档。</p>
<h3>注意</h3>
<p>并非所有的HTML元素都有开始和结束标记。如果我们查看Hello，World页面的<code>head</code>标记中的元素，我们可以看到有几个<code>meta</code>元素，每个元素只由一个标记组成。</p>
<p>这些元素不允许有内容，HTML中有很多这样的元素。</p>
<h3>HTML属性</h3>
<p>除了名称，我们还可以为给定的HTML元素定义一组属性。对于这个项目，我们需要知道几个非常常见的属性，叫做<code>class</code>和<code>id</code>。</p>
<p>下面是一个设置了<code>class</code>和<code>id</code>属性的HTML元素的例子。</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">"header"</span> <span class="na">id</span><span class="o">=</span><span class="s">"pageTitle"</span><span class="p">&gt;</span>Hello World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div>

<p>这种方法的语法非常简单。我们只有属性的名称，后跟一个符号和一个描述与该属性相关的值的字符串。</p>
<p><code>class</code>和<code>id</code>属性为我们提供了引用HTML文档不同部分的方法，它们通常用于应用样式，或者用JavaScript与页面上的元素进行交互。</p>
<p>在我们的例子中，它们对于获取页面上的元素非常有用。</p>
<h2>CSS选择器快速入门</h2>
<p>CSS是另一种语言(简称为<strong>C</strong>as cading<strong>S</strong>tyle<strong>S</strong>sheets ),用于定义HTML文档的元素实际应该是什么样子。</p>
<p>在这个项目中，我们不打算做任何样式设计，但是我们确实需要了解一点选择器语法，这是我们如何描述一个样式适用于哪些元素的。这与我们相关的原因是因为<code>BeautifulSoup</code>允许我们使用这些选择器搜索HTML文档，它们非常强大。</p>
<h3>基本选择器</h3>
<p>首先，让我们讨论如何通过元素名、类和id进行选择。</p>
<p>选择页面上元素的所有实例非常容易，因为选择器就是元素名称。例如，如果我们想要选择所有的<code>h1</code>标签，我们可以只写<code>h1</code>。</p>
<p>如果我们想通过一个类进行选择，我们必须写下这个类的名字，以一个句点(<code>.</code>)为前缀。</p>
<p>回到这个例子，</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">"header"</span> <span class="na">id</span><span class="o">=</span><span class="s">"pageTitle"</span><span class="p">&gt;</span>Hello World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div>

<p>我们可以使用选择器<code>.header</code>获取这个<code>h1</code>标签，因为<code>header</code>类被列在这个特定的<code>h1</code>标签的类中。</p>
<p>为了通过<code>id</code>进行搜索，我们需要使用<code>#</code>后跟<code>id</code>的名字。对于上面的例子，选择器应该是这样的:<code>#pageTitle</code>。</p>
<p>理论上，id应该是唯一的，所以通过<code>id</code>选择应该提供单个元素，但是HTML没有强制这样做，所以我们不能指望它。</p>
<h3>组合CSS选择器</h3>
<p>有时我们不能用一个术语准确地说明我们的意思，所以我们可以将选择器组合成更具体的选择器。</p>
<p>例如，如果我们想确保只选择带有<code>header</code>类的<code>h1</code>元素，而不是带有<code>header</code>类的<code>h2</code>元素，我们可以这样写:</p>


<p>通过在选择器之间放置一个空格，我们可以暗示一个层次结构。下面的意思是"<code>div</code>内带有header类的<code>h1</code>元素":</p>


<p>我们可以比这复杂得多，但是这些相对简单的选择器足以让我们开始这个项目。</p>
<p>你可以在这里找到更多关于不同CSS选择器的信息。</p>
<h2>开始使用<code>BeautifulSoup</code></h2>
<p>至此，您已经知道了安装第三方模块的步骤，所以没有必要在此重复。如果你卡住了，你可以在<a href="/30-days-of-python/python-30-day-27-local-development/">第27天</a>的帖子中找到信息，或者你可以遵循<code>BeautifulSoup</code> <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-beautiful-soup">安装指南</a>。</p>
<h3>解析HTML</h3>
<p>让我们试着从<code>BeautifulSoup</code>文档中解析一些样本HTML，看起来像这样:</p>
<div class="codehilite"><pre><span/><code><span class="n">html_doc</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">&lt;html&gt;</span>

<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;title&gt;The Dormouse's story&lt;/title&gt;</span>
<span class="s2">&lt;/head&gt;</span>

<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;p class="title"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;</span>

<span class="s2">    &lt;p class="story"&gt;</span>
<span class="s2">        Once upon a time there were three little sisters; and their names were</span>
<span class="s2">        &lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;Elsie&lt;/a&gt;,</span>
<span class="s2">        &lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and</span>
<span class="s2">        &lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;;</span>
<span class="s2">        and they lived at the bottom of a well.</span>
<span class="s2">    &lt;/p&gt;</span>

<span class="s2">&lt;/body&gt;</span>

<span class="s2">&lt;/html&gt;</span>
<span class="s2">"""</span>
</code></pre></div>

<p>这里我们正在处理一个多行字符串，它包含一些HTML格式的文本。稍后，我们将直接从网站获取HTML。过程是一样的。</p>
<p><code>BeautifulSoup</code>的导入有点奇怪。</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</code></pre></div>

<p>注意不要试图导入<code>from BeautifulSoup</code>。那不行。</p>
<p>导入<code>BeautifulSoup</code>后，我们需要做的就是解析文件:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">html_doc</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">&lt;html&gt;</span>

<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;title&gt;The Dormouse's story&lt;/title&gt;</span>
<span class="s2">&lt;/head&gt;</span>

<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;p class="title"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;</span>

<span class="s2">    &lt;p class="story"&gt;</span>
<span class="s2">        Once upon a time there were three little sisters; and their names were</span>
<span class="s2">        &lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;Elsie&lt;/a&gt;,</span>
<span class="s2">        &lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and</span>
<span class="s2">        &lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;;</span>
<span class="s2">        and they lived at the bottom of a well.</span>
<span class="s2">    &lt;/p&gt;</span>

<span class="s2">&lt;/body&gt;</span>

<span class="s2">&lt;/html&gt;</span>
<span class="s2">"""</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>
</code></pre></div>

<p>现在我们可以使用<code>soup</code>轻松地在源文档中找到我们想要的东西。</p>
<h2>从混乱中获取数据</h2>
<p>汤里面的物品是<code>Tag</code>物体。这是由BeautifulSoup作者创建的一种特殊类型，用于存储HTML文档中给定元素的信息。当我们在<code>soup</code>中搜索以获得页面上的特定元素时，我们将得到一个<code>Tag</code>或一列<code>Tag</code>对象。</p>
<p><code>Tag</code>对象有很多有用的方法和属性，比如<code>content</code>，它让我们看到给定元素内部的内容。如果标签只包含文本内容，我们可以使用<code>string</code>属性来获取内容。我们一会儿会看到一个例子。</p>
<p>如果我们想获得一个属性的值，我们可以把标签当作一个字典，标签名就是键。因此，如果我们想要给定标签的<code>class</code>属性的内容，我们可以编写<code>tag["class"]</code>。</p>
<p>我们可以使用<code>select</code>和<code>select_one</code>方法搜索<code>soup</code>，这两个方法接受CSS选择器作为字符串。</p>
<p>例如，假设我们想从上面的HTML文档中获取姐妹的名字。我们可以这样做:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">html_doc</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">&lt;html&gt;</span>

<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;title&gt;The Dormouse's story&lt;/title&gt;</span>
<span class="s2">&lt;/head&gt;</span>

<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;p class="title"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;</span>

<span class="s2">    &lt;p class="story"&gt;</span>
<span class="s2">        Once upon a time there were three little sisters; and their names were</span>
<span class="s2">        &lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;Elsie&lt;/a&gt;,</span>
<span class="s2">        &lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and</span>
<span class="s2">        &lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;;</span>
<span class="s2">        and they lived at the bottom of a well.</span>
<span class="s2">    &lt;/p&gt;</span>

<span class="s2">&lt;/body&gt;</span>

<span class="s2">&lt;/html&gt;</span>
<span class="s2">"""</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>
<span class="n">sisters</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">".sister"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sister</span> <span class="ow">in</span> <span class="n">sisters</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sister</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
</code></pre></div>

<p>这里<code>soup.select(".sister")</code>给了我们一个作为<code>Tag</code>对象的<code>&lt;a&gt;</code>元素列表。然后我们遍历列表，这意味着对于任何给定的迭代，<code>sister</code>包含一个<code>Tag</code>。</p>
<p>因为<code>&lt;a&gt;</code>元素只包含文本，所以我们可以通过访问标签的<code>string</code>属性来提取文本内容。</p>
<p>希望这些都有意义。如果你想更深入地研究<code>BeautifulSoup</code>，你可以在这里找到文档<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#making-the-soup">。</a></p>
<h2>案情摘要</h2>
<p>唷！这需要涵盖很多内容，但是我们现在已经准备好处理实际的项目了。</p>
<p>对于这个项目，我们将刮一个名为<a href="http://books.toscrape.com/">http://books.toscrape.com/</a>的网站。这是一个专门用来学习如何抓取真实网站的网站。</p>
<p>你需要做的是刮这个网站的首页，并抓取该页面上每本书的一些数据。</p>
<p>对于每本书，我要你抓住标题，星级和价格。您应该将所有这些信息以CSV格式写入一个新文件。</p>
<p>在做这些之前，您需要获得实际的HTML文档。为此，请在文件中添加以下几行:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
</code></pre></div>

<p>注意，您必须安装<code>requests</code>库，因为它不是标准库的一部分。</p>
<p>实际查看HTML时，您有几个选项。通过在您的<code>soup</code>上使用<code>prettify</code>方法，您可以以一种很好的格式获得数据，您可以将数据写入文件或打印到控制台。你也可以直接进入网站，在页面上点击右键。您应该看到一个查看页面源代码的选项。如果你看不到这个，试着按下<code>ctrl</code> + <code>u</code>。</p>
<p>祝项目好运！</p>
<h2>我们的解决方案</h2>
<p>首先，让我们把所有的进口和初始设置有序。</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>
</code></pre></div>

<p>在我们继续之前，我们真的需要看一下HTML代码，看看如何最好地获取我们正在寻找的数据。</p>
<p>每本书都作为有序列表(<code>&lt;ol&gt;</code>标签)的一部分存储为列表项(<code>&lt;li&gt;</code>标签)，如下所示:</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-xs-6 col-sm-4 col-md-3 col-lg-3"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">article</span> <span class="na">class</span><span class="o">=</span><span class="s">"product_pod"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"image_container"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"catalogue/a-light-in-the-attic_1000/index.html"</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">img</span>
                    <span class="na">src</span><span class="o">=</span><span class="s">"media/cache/2c/da/2cdad67c44b002e7ead0cc35693c0e8b.jpg"</span>
                    <span class="na">alt</span><span class="o">=</span><span class="s">"A Light in the Attic"</span>
                    <span class="na">class</span><span class="o">=</span><span class="s">"thumbnail"</span>
                <span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"star-rating Three"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"catalogue/a-light-in-the-attic_1000/index.html"</span> <span class="na">title</span><span class="o">=</span><span class="s">"A Light in the Attic"</span><span class="p">&gt;</span>
                A Light in the ...
            <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"product_price"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"price_color"</span><span class="p">&gt;</span>£51.77<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"instock availability"</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-ok"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
                In stock
            <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

            <span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary btn-block"</span> <span class="na">data-loading-text</span><span class="o">=</span><span class="s">"Adding..."</span><span class="p">&gt;</span>
                    Add to basket
                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</code></pre></div>

<p>我们不需要担心这些信息的大部分。例如，每个<code>&lt;li&gt;</code>的第一部分专用于图像。底部还有一个小的<code>form</code>元素，用于向购物篮中添加一本书。</p>
<p>让我们把它分成几个部分，这样我们可以更好地推理到底发生了什么。</p>
<p>对于价格，我们关心的是这一部分:</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"product_price"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"price_color"</span><span class="p">&gt;</span>£51.77<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"instock availability"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-ok"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
        In stock
     <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

     <span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary btn-block"</span> <span class="na">data-loading-text</span><span class="o">=</span><span class="s">"Adding..."</span><span class="p">&gt;</span>
            Add to basket
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>更方便的是，价格在它自己的<code>&lt;p&gt;</code>标签中，并且有一个与之相关联的类。如果我们扫描文档，我们还会发现它是一个唯一的类，仅用于价格。</p>
<p>因此，使用一个非常简单的选择器:<code>".price_color"</code>就可以获得包含价格的<code>p</code>标签。</p>
<p>标题有点复杂。它位于这里:</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"catalogue/a-light-in-the-attic_1000/index.html"</span> <span class="na">title</span><span class="o">=</span><span class="s">"A Light in the Attic"</span><span class="p">&gt;</span>
        A Light in the ...
    <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
</code></pre></div>

<p>这里我们没有任何类或id可以使用，而且书名实际上也不是<code>&lt;a&gt;</code>标签中的字符串内容。如果我们查看，较长的标题会被截断，所以我们需要查看<code>title</code>属性中的值。</p>
<p>在这种情况下，我认为我们应该使用这样的选择器:</p>


<p>这是在寻找位于<code>h3</code>元素内部的<code>a</code>元素，也就是位于具有类<code>.product_pod</code>的元素内部的<code>a</code>元素。<code>product_pod</code>从何而来？它是添加到包含我们的<code>h3</code>标签的<code>article</code>元素中的一个类。</p>
<p>这个选择器足够具体，我们不太可能意外地选择了我们不想要的东西。否则，我们将不得不使用一个更加特殊的选择器。</p>
<p>最后，让我们看看评级的HTML。</p>
<div class="codehilite"><pre><span/><code><span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"star-rating Three"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">"icon-star"</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</code></pre></div>

<p>这里我们有另一个简单的选择器选项，我们可以只寻找<code>star-rating</code>类。不过，获取我们需要的信息会有点困难，因为一本书的星级数是由另一个类表示的。因此，我们必须创建一些方法来检索第二个类，并将其转换成我们在程序中更容易使用的东西。</p>
<p>现在我们已经分析了HTML，让我们实现代码来获取我们想要的标签。</p>
<p>作为一个小提示，我将把我们的选择器存储在变量中，这样它们更容易重用。</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">price_selector</span> <span class="o">=</span> <span class="s2">".price_color"</span>
<span class="n">title_selector</span> <span class="o">=</span> <span class="s2">".product_pod h3 a"</span>
<span class="n">rating_selector</span> <span class="o">=</span> <span class="s2">".star-rating"</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">price_selector</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">title_selector</span><span class="p">)</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rating_selector</span><span class="p">)</span>
</code></pre></div>

<p>这里的一个好处是我们的标签有一致的顺序，因为我们处理的是列表。因此，我们可以使用<code>zip</code>将不同的值组合到原始书籍中。</p>
<p>然后我们可以使用一个<code>for</code>循环来迭代<code>zip</code>对象，这样我们就可以处理给定书籍的所有数据。现在我只关注打印值，但是这个<code>for</code>循环最终会转移到上下文管理器中。</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">price_selector</span> <span class="o">=</span> <span class="s2">".price_color"</span>
<span class="n">title_selector</span> <span class="o">=</span> <span class="s2">".product_pod h3 a"</span>
<span class="n">rating_selector</span> <span class="o">=</span> <span class="s2">".star-rating"</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">price_selector</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">title_selector</span><span class="p">)</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rating_selector</span><span class="p">)</span>

<span class="k">for</span> <span class="n">price</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">ratings</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>

<p>我们现在可以处理每个标签来获得我们想要的值。对于<code>price</code>，这很容易:我们只需要找到标签的<code>string</code>属性。</p>
<p>Title稍微难一点，但是仍然可以管理，因为我们有一个包含完整标题的属性。正如我们在<code>BeautifulSoup</code>的简短介绍中所讨论的，我们可以像字典一样对待标签，像键一样访问属性值。</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">price_selector</span> <span class="o">=</span> <span class="s2">".price_color"</span>
<span class="n">title_selector</span> <span class="o">=</span> <span class="s2">".product_pod h3 a"</span>
<span class="n">rating_selector</span> <span class="o">=</span> <span class="s2">".star-rating"</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">price_selector</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">title_selector</span><span class="p">)</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rating_selector</span><span class="p">)</span>

<span class="k">for</span> <span class="n">price</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">ratings</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">title</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span><span class="si">}</span><span class="s2"> costs </span><span class="si">{</span><span class="n">price</span><span class="o">.</span><span class="n">string</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>

<p>谜题的最后一块是收视率。为了将类名转换成实际的星级，我将使用一个函数。</p>
<p>我还将定义一个字典，以便我们可以将给定的类名映射到更有用的东西。在这种情况下，我将把类名映射到由<code>"★"</code>字符组成的字符串。</p>
<div class="codehilite"><pre><span/><code><span class="n">rating_mappings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"One"</span><span class="p">:</span>   <span class="s2">"★"</span><span class="p">,</span>
    <span class="s2">"Two"</span><span class="p">:</span>   <span class="s2">"★ ★"</span><span class="p">,</span>
    <span class="s2">"Three"</span><span class="p">:</span> <span class="s2">"★ ★ ★"</span><span class="p">,</span>
    <span class="s2">"Four"</span><span class="p">:</span>  <span class="s2">"★ ★ ★ ★"</span><span class="p">,</span>
    <span class="s2">"Five"</span><span class="p">:</span>  <span class="s2">"★ ★ ★ ★ ★"</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">get_rating</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="n">rating_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">tag</span><span class="p">[</span><span class="s2">"class"</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">rating</span>
</code></pre></div>

<p>我上面定义的函数接收一个标签，然后使用我们的<code>rating_mappings</code>字典来确定哪个术语是这个<code>Tag</code>中使用的类名。</p>
<p>我们通过检查我们的<code>rating_mappings</code>键是否是与这个<code>Tag</code>的<code>"class"</code>键相关联的列表的成员来做到这一点。</p>
<p>如果找到匹配，我们返回与我们的<code>rating_mappings</code>字典中的关键字相关联的星级字符串。</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="k">def</span> <span class="nf">get_rating</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="n">rating_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">tag</span><span class="p">[</span><span class="s2">"class"</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">rating</span>

<span class="n">rating_mappings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"One"</span><span class="p">:</span>   <span class="s2">"★"</span><span class="p">,</span>
    <span class="s2">"Two"</span><span class="p">:</span>   <span class="s2">"★ ★"</span><span class="p">,</span>
    <span class="s2">"Three"</span><span class="p">:</span> <span class="s2">"★ ★ ★"</span><span class="p">,</span>
    <span class="s2">"Four"</span><span class="p">:</span>  <span class="s2">"★ ★ ★ ★"</span><span class="p">,</span>
    <span class="s2">"Five"</span><span class="p">:</span>  <span class="s2">"★ ★ ★ ★ ★"</span>
<span class="p">}</span>

<span class="n">price_selector</span> <span class="o">=</span> <span class="s2">".price_color"</span>
<span class="n">title_selector</span> <span class="o">=</span> <span class="s2">".product_pod h3 a"</span>
<span class="n">rating_selector</span> <span class="o">=</span> <span class="s2">".star-rating"</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">price_selector</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">title_selector</span><span class="p">)</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rating_selector</span><span class="p">)</span>

<span class="k">for</span> <span class="n">price</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">ratings</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">title</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span><span class="si">}</span><span class="s2"> costs </span><span class="si">{</span><span class="n">price</span><span class="o">.</span><span class="n">string</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">get_rating</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>

<p>一旦我们确认一切正常，我们就可以修改我们的<code>for</code>循环，这样我们就可以写入一个文件。在这种情况下，因为我使用了一个特殊的<code>★</code>字符，我们需要显式地为我们的文件指定一个编码。</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="k">def</span> <span class="nf">get_rating</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="n">rating_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">tag</span><span class="p">[</span><span class="s2">"class"</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">rating</span>

<span class="n">rating_mappings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"One"</span><span class="p">:</span>   <span class="s2">"★"</span><span class="p">,</span>
    <span class="s2">"Two"</span><span class="p">:</span>   <span class="s2">"★ ★"</span><span class="p">,</span>
    <span class="s2">"Three"</span><span class="p">:</span> <span class="s2">"★ ★ ★"</span><span class="p">,</span>
    <span class="s2">"Four"</span><span class="p">:</span>  <span class="s2">"★ ★ ★ ★"</span><span class="p">,</span>
    <span class="s2">"Five"</span><span class="p">:</span>  <span class="s2">"★ ★ ★ ★ ★"</span>
<span class="p">}</span>

<span class="n">price_selector</span> <span class="o">=</span> <span class="s2">".price_color"</span>
<span class="n">title_selector</span> <span class="o">=</span> <span class="s2">".product_pod h3 a"</span>
<span class="n">rating_selector</span> <span class="o">=</span> <span class="s2">".star-rating"</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"http://books.toscrape.com/"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">price_selector</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">title_selector</span><span class="p">)</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rating_selector</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"books.csv"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">book_file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">price</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">ratings</span><span class="p">):</span>
        <span class="n">book_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">title</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">price</span><span class="o">.</span><span class="n">string</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">get_rating</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>

<p>就这样，我们结束了！</p>
<p>如果我们看一下我们的<code>books.csv</code>文件，我们现在有这样的内容:</p>
<div class="codehilite"><pre><span/><code>A Light in the Attic,£51.77,★ ★ ★
Tipping the Velvet,£53.74,★
Soumission,£50.10,★
Sharp Objects,£47.82,★ ★ ★ ★
Sapiens: A Brief History of Humankind,£54.23,★ ★ ★ ★ ★
The Requiem Red,£22.65,★
The Dirty Little Secrets of Getting Your Dream Job,£33.34,★ ★ ★ ★
The Coming Woman: A Novel Based on the Life of the Infamous Feminist, Victoria Woodhull,£17.93,★ ★ ★
The Boys in the Boat: Nine Americans and Their Epic Quest for Gold at the 1936 Berlin Olympics,£22.60,★ ★ ★ ★
The Black Maria,£52.15,★
Starving Hearts (Triangular Trade Trilogy, #1),£13.99,★ ★
Shakespeare's Sonnets,£20.66,★ ★ ★ ★
Set Me Free,£17.46,★ ★ ★ ★ ★
Scott Pilgrim's Precious Little Life (Scott Pilgrim #1),£52.29,★ ★ ★ ★ ★
Rip it Up and Start Again,£35.02,★ ★ ★ ★ ★
Our Band Could Be Your Life: Scenes from the American Indie Underground, 1981-1991,£57.25,★ ★ ★
Olio,£23.88,★
Mesaerion: The Best Science Fiction Stories 1800-1849,£37.59,★
Libertarianism for Beginners,£51.33,★ ★
It's Only the Himalayas,£45.17,★ ★
</code></pre></div>

<p>如果你想扩展这个项目一点点，尝试刮多页。网站上有50页的书，分页有一致的URL格式，所以如果你想的话，你可以一次抓取一页。</p>
<p>您可能还想尝试抓取一些书籍的详细页面，以获取特定书籍的更多信息。</p> 
                </article>
            
            </div>    
</body>
</html>