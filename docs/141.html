<html>
<head>
<title>Day 16: First Class Functions and Lambda Expressions | Teclado</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>第16天:第一类函数和Lambda表达式</h1>
<blockquote>原文：<a href="https://blog.teclado.com/python-30-day-16-lambda-expressions/">https://blog.teclado.com/python-30-day-16-lambda-expressions/</a></blockquote><div><article class="pb-12 prose prose-p:font-copy col-start-2 dark:prose-invert">
                    
                    <p>欢迎来到Python 系列<a href="https://blog.teclado.com/30-days-of-python/"> 30天的第16天！今天我们将讨论一级函数的概念。Python中的所有函数都是一级函数，我们将稍微讨论一下这意味着什么，以及它为什么有用。</a></p>
<p>我们还将看到使用lambda表达式定义简单函数的不同方式。</p>
<h2>什么是一流的功能？</h2>
<p>当一种编程语言中的函数被像对待其他类型的函数一样对待时，该语言被称为具有一级函数。据说他们是这种语言的“一等公民”。</p>
<p>一般来说，这意味着我们可以将函数作为参数传递给其他函数，从函数中返回它们，并将它们赋给变量。</p>
<p>在Python中，函数确实是一等公民，我们可以做我上面列出的所有事情。让我们看一些例子。</p>
<h2>将函数分配给变量</h2>
<p>首先，我们来谈谈将函数赋给变量，因为这实际上是在Python中创建函数的一个至关重要的部分。</p>
<p>当我们使用<code>def</code>定义函数时，我们为函数提供了一个名称。当我们这样做的时候会发生两件事。</p>
<p>这个函数是根据我们的规范命名的。</p>
<p>回顾第13天的<a href="/30-days-of-python/python-30-day-13-return-statements/">，当我们打印出全局名称空间时，我们发现了如下条目:</a></p>
<div class="codehilite"><pre><span/><code><span class="o">&lt;</span><span class="n">function</span> <span class="n">add</span> <span class="n">at</span> <span class="mh">0x7fae512021f0</span><span class="o">&gt;</span>
</code></pre></div>

<p>函数名成为函数表示的一部分。</p>
<p>Python用这个名字为我们创建了一个变量，它把函数赋给这个名字。</p>
<p>这实际上是两件非常不同的事情，我们可以通过将一个函数赋给不同的变量名，并打印出与这些不同名称相关的值来演示这一点。</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="n">adder</span> <span class="o">=</span> <span class="n">add</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adder</span><span class="p">)</span>
</code></pre></div>

<p>如果我们运行代码，我们将得到类似如下的输出:</p>
<div class="codehilite"><pre><span/><code><span class="o">&lt;</span><span class="n">function</span> <span class="n">add</span> <span class="n">at</span> <span class="mh">0x7f11bc6451f0</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">function</span> <span class="n">add</span> <span class="n">at</span> <span class="mh">0x7f11bc6451f0</span><span class="o">&gt;</span>
</code></pre></div>

<p>这里有几件有趣的事情需要注意。</p>
<p>首先，这两个函数是完全相同的对象。我们可以看到这一点，因为它们的内存地址(在最右边)是相同的。</p>
<p>其次，当我们打印函数的字符串表示时，这两个函数仍然被称为<code>add</code>。第二个输出没有变成这样:</p>
<div class="codehilite"><pre><span/><code><span class="o">&lt;</span><span class="n">function</span> <span class="n">adder</span> <span class="n">at</span> <span class="mh">0x7f11bc6451f0</span><span class="o">&gt;</span>
</code></pre></div>

<p>这是因为我们用来引用函数的变量名和函数名是两码事。</p>
<p>通过执行以下操作，我们可以非常清楚地展示这一点:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="n">adder</span> <span class="o">=</span> <span class="n">add</span>
<span class="k">del</span> <span class="n">add</span>

<span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># NameError</span>
</code></pre></div>

<p>这里我们已经删除了变量名<code>add</code>，所以我们不能再用这个名字调用函数。如果我们尝试，我们会得到一个<code>NameError</code>:</p>
<div class="codehilite"><pre><span/><code><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">"main.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">8</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">'add'</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</code></pre></div>

<p>尽管如此，我们仍然可以调用<code>adder</code>，函数的名字仍然是<code>add</code>:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="n">adder</span> <span class="o">=</span> <span class="n">add</span>
<span class="k">del</span> <span class="n">add</span>

<span class="n">adder</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>   <span class="c1"># 9</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adder</span><span class="p">)</span>  <span class="c1"># &lt;function add at 0x7f03780ae1f0&gt;</span>
</code></pre></div>

<h2>作为参数的函数</h2>
<p>既然我们可以将函数赋给变量，那么我们也可以将函数作为参数传入是有意义的。为什么？因为形参实际上只是变量，而实参是我们赋给那些变量的值。</p>
<p>让我们看一个有趣的例子，我们可以把一个函数作为参数传入。</p>
<p>Python有一个名为<code>max</code>的函数，它可以让我们在一些iterable中找到最大值。</p>
<p>对于元素具有自然顺序的iterable来说，它非常容易使用:我们只需将iterable传递给max，它就会发挥它的魔力。</p>
<div class="codehilite"><pre><span/><code><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">56</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">73</span><span class="p">]</span>
<span class="n">highest_number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">highest_number</span><span class="p">)</span>  <span class="c1"># 102</span>
</code></pre></div>

<p>然而，并不是每组值都有明显的顺序。例如，假设我有一个这样的字典列表:</p>
<div class="codehilite"><pre><span/><code><span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Hannah"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">83</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Charlie"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">91</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Peter"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">85</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Rachel"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">79</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Lauren"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">92</span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>

<p>实际上，我们可以按字母顺序或平均成绩来排序。然而，在这种情况下，<code>max</code>实际上是试图使用<code>&gt;</code>操作符将整个字典与另一个字典进行比较，这甚至都不是合法的操作。</p>
<p>在这种情况下，我们可以通过为名为<code>key</code>的关键字参数提供一个函数来帮助<code>max</code>函数。iterable中的每一项都调用这个函数，每一项都传递给这个函数，一次一项。</p>
<p>这个函数所期望的是一个可排序的值，它可以用来确定给定项目的顺序。</p>
<p>例如，我们可以提供这样一个函数:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">get_grade_average</span><span class="p">(</span><span class="n">student</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">student</span><span class="p">[</span><span class="s2">"grade_average"</span><span class="p">]</span>
</code></pre></div>

<p>该函数接受一个字典，并返回与该字典的<code>"grade_average"</code>键相关联的值。在我们的例子中，这是一个整数，可以使用<code>&gt;</code>合法地比较整数。</p>
<p>我们现在可以这样做:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">get_grade_average</span><span class="p">(</span><span class="n">student</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">student</span><span class="p">[</span><span class="s2">"grade_average"</span><span class="p">]</span>

<span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Hannah"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">83</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Charlie"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">91</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Peter"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">85</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Rachel"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">79</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Lauren"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">92</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">valedictorian</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">get_grade_average</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">valedictorian</span><span class="p">)</span>
</code></pre></div>

<p>这里我们提供了<code>get_grade_average</code>函数作为<code>max</code>的参数，<code>max</code>在内部调用这个函数来确定列表中条目的顺序。然后，它正确地将该词典作为平均分数最高的学生返回:</p>
<div class="codehilite"><pre><span/><code><span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Lauren"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">92</span><span class="p">}</span>
</code></pre></div>

<p>还有其他函数和方法需要类似的函数。例如，<code>sorted</code>函数和<code>sort</code>方法都接受键，键必须是函数。</p>
<h2>从其他函数返回函数</h2>
<p>在这一点上，我认为很明显我们<em>可以从其他函数中返回函数，但问题是，我们为什么要这样做？</em></p>
<p>在这里，我想向您展示一个使用字典的<code>get</code>方法的模式，它将允许我们让用户选择一个函数来运行。方法实际上只是函数的特殊类型，所以<code>get</code>将作为一个很好的演示。</p>
<p>首先，我们需要一些函数，所以我将使用我们在第12天的<a href="/30-days-of-python/python-30-day-12-exercise-solutions/">练习中定义的运算符函数。</a></p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"You can't divide by 0!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div>

<p>这些都是很好的例子，因为它们都有两个论点，而且主题相似。</p>
<p>下一步是定义这样一个字典:</p>
<div class="codehilite"><pre><span/><code><span class="n">operations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"a"</span><span class="p">:</span> <span class="n">add</span><span class="p">,</span>
    <span class="s2">"s"</span><span class="p">:</span> <span class="n">subtract</span><span class="p">,</span>
    <span class="s2">"m"</span><span class="p">:</span> <span class="n">multiply</span><span class="p">,</span>
    <span class="s2">"d"</span><span class="p">:</span> <span class="n">divide</span>
<span class="p">}</span>
</code></pre></div>

<p>值得注意的是，我们在这里并没有调用函数:我们只是使用它们的变量名来引用函数。</p>
<p>现在我们有了一个字典，其中的键是字符串，与这些键相关联的值是函数。我们现在可以要求用户从这些选项中进行选择，我们将通过在字典中查找他们的选项来为他们运行该函数:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"You can't divide by 0!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>

<span class="n">operations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"a"</span><span class="p">:</span> <span class="n">add</span><span class="p">,</span>
    <span class="s2">"s"</span><span class="p">:</span> <span class="n">subtract</span><span class="p">,</span>
    <span class="s2">"m"</span><span class="p">:</span> <span class="n">multiply</span><span class="p">,</span>
    <span class="s2">"d"</span><span class="p">:</span> <span class="n">divide</span>
<span class="p">}</span>

<span class="n">selected_option</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"""Please select one of the following options:</span>

<span class="s2">a: add</span>
<span class="s2">s: subtract</span>
<span class="s2">m: multiply</span>
<span class="s2">d: divide</span>

<span class="s2">What would you like to do? """</span><span class="p">)</span>

<span class="n">operation</span> <span class="o">=</span> <span class="n">operations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_option</span><span class="p">)</span>

<span class="k">if</span> <span class="n">operation</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">"Please enter a value for a: "</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">"Please enter a value for b: "</span><span class="p">))</span>

    <span class="n">operation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Invalid selection"</span><span class="p">)</span>
</code></pre></div>

<p>当我们调用<code>get</code>时，我们在字典中查找用户的字符串，并且(假设没有出错)我们得到的是一个函数。然后，我们可以将这个函数赋给一个变量名，并像调用任何其他函数一样调用它。</p>
<p>如果确实出错了，我们有一些保护措施，因为当没有找到键时，<code>get</code>方法返回<code>None</code>,我们可以使用一个条件语句来检查这一点，以确保我们没有得到一个falsy值。如果我们做了，我们知道我们没有得到一个函数，所以我们可以让用户知道他们的选择是无效的。</p>
<h2>λ表达式</h2>
<p>Lambda表达式是定义简单函数的另一种语法。lambda表达式的一个非常有用的特性是，它们是<em>表达式</em>，它们评估的值是我们想要创建的函数。</p>
<p>相反，使用<code>def</code>关键字的函数定义是语句。它们没有一个值，这就是为什么Python不厌其烦地为我们指定函数的名称。这样做的一个主要限制是，我们总是必须将我们的函数与我们想要使用它们的地方分开定义。</p>
<p>例如，我们必须在使用<code>max</code>中的关键函数之前定义它:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">get_grade_average</span><span class="p">(</span><span class="n">student</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">student</span><span class="p">[</span><span class="s2">"grade_average"</span><span class="p">]</span>

<span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Hannah"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">83</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Charlie"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">91</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Peter"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">85</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Rachel"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">79</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Lauren"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">92</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">valedictorian</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">get_grade_average</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">valedictorian</span><span class="p">)</span>
</code></pre></div>

<p>使用<code>def</code>时，无法将函数定义为<code>max</code>调用的一部分。然而，当使用lambda表达式时，我们没有这样的限制，这使得它们对于像key函数这样的通常只有一行函数体的东西非常方便。</p>
<p>好的，那么我们如何写一个lambda表达式呢？</p>
<p>任何lambda表达式的第一部分都是关键字<code>lambda</code>。在lambda关键字之后，我们可以选择为我们想要创建的函数指定任何参数。与常规函数定义不同，这些值没有放在括号内。lambda表达式的这一部分用冒号封闭。</p>
<p>冒号后面是一个表达式，这个表达式就是我们想要从函数中返回的。</p>
<p>让我们看几个例子，从之前的<code>add</code>函数开始。</p>


<p>这里我们有两个参数，<code>a</code>和<code>b</code>，它们位于<code>lambda</code>关键字之后，冒号之前。冒号标志着我们想要定义的参数的结尾，后面的所有内容都是我们想要从函数中返回的。在这种情况下，我们要返回的是<code>a + b</code>。</p>
<p>为了便于比较，下面是使用<code>def</code>编写的相同函数:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</code></pre></div>

<p>现在让我们看看我们用作<code>max</code>的关键函数的<code>get_grade_average</code>:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">get_grade_average</span><span class="p">(</span><span class="n">student</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">student</span><span class="p">[</span><span class="s2">"grade_average"</span><span class="p">]</span>
</code></pre></div>

<p>这个函数接受一个参数<code>student</code>，我们期望它是一个字典。它返回订阅表达式的结果，该表达式在提供的字典中查找与键<code>"grade_average"</code>相关联的值。</p>
<p>以lambda表达式的形式编写，该函数如下所示:</p>
<div class="codehilite"><pre><span/><code><span class="k">lambda</span> <span class="n">student</span><span class="p">:</span> <span class="n">student</span><span class="p">[</span><span class="s2">"grade_average"</span><span class="p">]</span>
</code></pre></div>

<p>我们可以在我们的小应用程序中使用它来查找分数最高的学生，如下所示:</p>
<div class="codehilite"><pre><span/><code><span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Hannah"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">83</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Charlie"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">91</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Peter"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">85</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Rachel"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">79</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Lauren"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">92</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">valedictorian</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">student</span><span class="p">:</span> <span class="n">student</span><span class="p">[</span><span class="s2">"grade_average"</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">valedictorian</span><span class="p">)</span>
</code></pre></div>

<p>如您所见，lambda表达式只是替换了对函数的引用，因为lambda表达式本身产生了一个函数。</p>
<p>我们可以很好地使用lambda表达式的另一个地方是我们之前的运算符映射字典:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">"You can't divide by 0!"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>

<span class="n">operations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"a"</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span>
    <span class="s2">"s"</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span>
    <span class="s2">"m"</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span>
    <span class="s2">"d"</span><span class="p">:</span> <span class="n">divide</span>
<span class="p">}</span>

<span class="n">selected_option</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"""Please select one of the following options:</span>

<span class="s2">a: add</span>
<span class="s2">s: subtract</span>
<span class="s2">m: multiply</span>
<span class="s2">d: divide</span>

<span class="s2">What would you like to do? """</span><span class="p">)</span>

<span class="n">operation</span> <span class="o">=</span> <span class="n">operations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_option</span><span class="p">)</span>

<span class="k">if</span> <span class="n">operation</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">"Please enter a value for a: "</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">"Please enter a value for b: "</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">operation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Invalid selection"</span><span class="p">)</span>
</code></pre></div>

<p>这里我们唯一不能替换的函数是<code>divide</code>，因为<code>divide</code>里面有一个条件语句。Lambda表达式仅限于单个表达式，不能包含语句。</p>
<p>记住，Python中的所有函数都是一级函数，所以如果我们愿意，可以将我们用lambda表达式创建的函数赋给变量。</p>
<div class="codehilite"><pre><span/><code><span class="n">add</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>  <span class="c1"># 15</span>
</code></pre></div>

<p>一般来说，这不是很有用。在这种情况下，用<code>def</code>定义函数通常更合适。它们更具可读性，在这种情况下，通过编写lambda表达式节省几行代码并不是一个很好的权衡。</p>
<h3>风格注释</h3>
<p>非常小心，不要在代码中滥用lambda表达式。虽然我们可以编写非常长且复杂的表达式作为返回值，但这不是一个好主意。</p>
<p>如果您需要一个执行任何真正复杂逻辑的函数，最好使用<code>def</code>来定义一个函数，并将操作分解成更简单的步骤，以便您可以使用描述性变量和注释来记录正在发生的事情。</p>
<h2>练习</h2>
<p>1)使用<code>sort</code>方法按照学生姓名的字母顺序排列以下列表:</p>
<div class="codehilite"><pre><span/><code><span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Hannah"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">83</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Charlie"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">91</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Peter"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">85</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Rachel"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">79</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Lauren"</span><span class="p">,</span> <span class="s2">"grade_average"</span><span class="p">:</span> <span class="mi">92</span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>

<p>这里你需要传入一个函数作为键，这取决于你是使用lambda表达式，还是用<code>def</code>定义一个函数。</p>
<p>2)将以下函数转换为lambda表达式，并将其赋给一个名为<code>exp</code>的变量。</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">exponentiate</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exponent</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base</span> <span class="o">**</span> <span class="n">exponent</span>
</code></pre></div>

<p>3)打印您在之前的练习中使用lambda表达式创建的函数。创建的函数的名称是什么？</p>
<p>你可以在这里找到我们的练习<a href="/30-days-of-python/python-30-day-16-exercise-solutions/">的答案。</a></p> 
                </article>
            
            </div>    
</body>
</html>