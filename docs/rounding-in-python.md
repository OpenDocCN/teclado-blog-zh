# Python 中的舍入

> 原文：<https://blog.teclado.com/rounding-in-python/>

最近，我们发布了一篇关于地板除法和模运算符的帖子，其中我们强调了在负数中使用这些运算符时一些潜在的意外行为。这种意外行为的来源原来是`floor`函数:在`math`模块中定义的几个舍入函数之一。

在这篇文章中，除了内置的`round`函数之外，我想更详细地介绍一下这些舍入函数，并强调一些你在使用它们时应该注意的事情。

## 地板

math 模块中的`floor`函数接受一个非复数作为参数，并返回一个整数。对于正数，`floor`相当于数学模块中的另一个函数`trunc`。

```
>>> floor(3.1)
3
>>> trunc(3.1)
3 
```

然而，当我们将负数作为参数传入时，`floor`和`trunc`的行为开始出现分歧。

```
>>> floor(-3.1)
-4
>>> trunc(-3.1)
-3 
```

那么为什么`floor(-3.1)`会返回`-4`？答案可以在数学模块的 [Python 文档](https://docs.python.org/3/library/math.html?highlight=floor#math.floor)中找到。

> 返回 x 的下限，即小于或等于 x 的最大整数。

所以`floor(-3.1)`返回`-4`，因为`-4`是小于`-3.1`的最大数。它沿着数字线更靠左。

另一方面，简单地截断我们作为参数提供的值，丢弃小数点后的所有内容。

这里重要的一点是，对于正数，`floor`将*舍入到*零，对于负数，*远离*零。

## 装天花板

`ceil`功能与`floor`相反。

> 返回 x 的上限，即大于等于 x 的最小整数。

对于正数，`ceil`使*远离*零。

```
>>> ceil(3.1)
4
>>> ceil(5.7)
6 
```

但是对于负数，`ceil`将*舍入到*零。

```
>>> ceil(-3.1)
-3
>>> ceil(-5.7)
-5 
```

在上面的例子中，`-3`大于`-3.1`。更接近于零。

## 轮次

与`ceil`、`floor`、`trunc`不同的是，`round`可以作为内置函数在标准库中找到。文档可以在[这里](https://docs.python.org/3/library/functions.html?highlight=round#round)找到。

我觉得用 round，最好先看几个例子。

```
>>> round(3.5)
4
>>> round(2.5)
2
>>> round(2.51)
3
>>> round(-3.5)
-4
>>> round(-2.5)
-2 
```

好的，首先要注意的是`round`，不像`ceil`和`floor`对正数和负数提供相同的结果，只是符号相反。然而，有些可疑的事情正在发生。`2.5`舍入到`2`(下舍入)，而`3.5`舍入到`4`(上舍入)。这是怎么回事？

### 银行家舍入

事实证明，`round`实现了一种叫做银行家舍入的舍入方法。那么，银行家的四舍五入是什么？又为什么会存在？

在大多数情况下，银行家的舍入方法如我们所料。它四舍五入到最接近的有效数字。所以`0.346`四舍五入到两位小数得出`0.35`。`5.3`四舍五入到最接近的整数得出`5`。银行家的四舍五入在处理平局方面很特别。

如果出现平局，例如`3.5`与`3`和`4`同样接近，银行家的舍入总是向最接近的**甚至**数舍入。`3.5`因此向`4`绕行，但`2.5`向`2`绕行，因为`2.5`比`4`更靠近`2`。

为什么我们要做这种舍入？

主要原因是，对于大组数字，银行家的舍入偏差较小，因此一系列带舍入数字的加减运算更准确地代表了未舍入数字的真实总和。我们可以很容易地想象一个例子，大量的正数被四舍五入，因此夸大了最终结果。使用银行家的舍入法，这些数字中的许多将被向下舍入，平衡那些向上舍入的数字，并产生一个更准确的结果。

## 概述

*   对于正数，`floor`总是将*舍入到*零，而对于负数，*总是远离*零。`3.1`因此使用`floor`舍入到`3`，但是`-3.1`舍入到`-4`。
*   `ceil`与`floor`相反，`ceil`总是将*向远离*零的方向舍入为正数，而将*向远离*零的方向舍入为负数。
*   `trunc`执行截断，返回给定数字的整数部分。
*   `round`实现一种称为银行家舍入的舍入类型。在银行家四舍五入法中，我们四舍五入到最接近的有效数字，除非出现平局。如果出现平局，我们将四舍五入到最接近的**甚至**有效数字。于是`3.5`绕到`4`，而`2.5`绕到`2`。

我希望你学到了新的东西，如果你想进一步提升你的 Python 技能，你可能想看看我们的[完整 Python 课程](https://www.udemy.com/the-complete-python-course/?couponCode=BLOGGER)。